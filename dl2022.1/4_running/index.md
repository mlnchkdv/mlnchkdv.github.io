# [⬅Глубокое обучение 2022.1](../index.html)

## Разработка и запуск нейронных сетей

[TOC]





### Запуск нейросети на компьютере - на примере распознания цветов

Настроим и обучим нейросеть распознавать картинки и говорить, какой цветок мы ей показываем — розу, тюльпан или что-то другое. Мы используем цветы, потому что скачали уже готовый, собранный и размеченный набор фотографий, на котором нейросеть может научиться. 

> Если вы хотите, чтобы она научилась распознавать на фото вас или ваших друзей, нужно будет собрать другой датасет и переобучить нейросеть.

Понадобится *Python* версии *3.8* и выше, обязательно под архитектуру *x64*. Если взять *32*-разрядную версию, то нужная в проекте библиотека *Tensorflow*  работать не будет. Мы используем версию [*3.9.7*](https://www.python.org/downloads/release/python-397/). Инструкция по [установке Python](https://thecode.media/py-install/). 

Все команды, которые есть в проекте, мы будем запускать в командной строке. Чтобы не было ошибок, лучше всего запустить её от имени администратора (в *Windows*) или с правами суперпользователя root (в *Mac OS* и *Linux*).



#### Создаём виртуальное окружение

Чтобы не раскидывать файлы, скрипты и картинки по всему компьютеру, создадим в питоне виртуальное окружение — специальный проект, который хранит все данные внутри своей папки. Он не мешает остальным проектам и не влияет на работу других программ, а также позволяет разворачивать проект на любом другом компьютере, где есть *Python*. Подробнее про *Virtual Environments* встроенный в *Puthon* и запуск файла [requirements.txt](../0_intro/requirements.txt) смотри в [инструкции](https://python.ivan-shamaev.ru/python-virtual-env-packages-virtualenv-venv-requirements-txt/).

Чтобы создать виртуальное окружение, в терминале перейдите в папку проекта и запустите команду:

```bash
python -m venv venv
```

В результате, в папке проекта будет создана папка **venv** с содержимым:

![](.\images\python_venv_env.jpg)

Далее необходимо активировать виртуальную среду, введя команду:

```bash
.\venv\Scripts\Activate.ps1
```

Префикс вашего рабочего каталога изменится на venv. Теперь пока ваша виртуальная среда активирована, **pip будет устанавливать пакеты в эту конкретную среду**, и вы сможете импортировать и использовать пакеты в своем приложении Python.

Теперь можно устанавливать пакеты в нашу виртуальную среду. Вы можете устанавливать каждый пакет по отдельности, вводя команду:

```bash
pip install pandas
```

Так вы получите последнюю версию пакеты, но можно указывать конкретную версию пакета, чтобы не столкнуться с несовместимостью некоторых новых функций:

```bash
pip install pandas==0.25.0
```

Для удобства, можно заранее вынести весь список необходимых библиотек в отдельный файл [requirements.txt](../0_intro/requirements.txt) и установить пакеты сразу все из этого списка, сохраним данный файл в корне проекта и запустим:

```bash
pip install -r requirements.txt
```

Всё, теперь у вас в виртуальном окружении установлены все необходимые пакеты для дальнейшей работы.



#### Установка*Tensorflow* 

На случай проблем с автоматической установкой *Tensorflow*, рассмотрим этап отдельной установки. Для установки пишем команду:

```bash
pip install tensorflow
```

Если на вашем компьютере установлен GPU и вы хотите задействовать его, то необходимо отменить установку пакета `tensorflow` и установить вместо него пакет `tensorflow-gpu`:

```bash
pip uninstall tensorflow
pip install tensorflow-gpu
```

Также может потребоваться установить совместимую библиотеку GPU.

Чтобы убедиться, что библиотека установилась правильно и работает штатно, проверим её простым тестом. Пишем команду:

```
python
```

Начало командной строки поменялось на >>> — это значит, что питон готов к приёму команд. Пишем по очереди:

```python
hello = tf.constant('Hello, TensorFlow')
sess = tf.compat.v1.Session()
print(sess.run(hello))
```

Если в консоли распечаталось 'Hello, TensorFlow', это значит, что всё работает правильно.







### Выводы



### Тест





---

### Источники





### Дополнительные материалы